# 开发指南 👨‍💻

本文档面向开发者，详细说明项目的技术实现和开发规范。

## 技术架构

### 前端框架
- **Vue 3.4+**: 使用 Composition API
- **TypeScript 5.4+**: 严格模式，完整类型支持
- **Vite 5.2+**: 快速的开发服务器和构建工具

### 状态管理
- **Pinia 2.1+**: Vue 官方推荐的状态管理库
- 使用 Composition API 风格
- 支持 TypeScript 类型推导

### 路由管理
- **Vue Router 4.3+**: Vue 官方路由
- 支持路由懒加载
- 自动更新页面标题

### UI 框架
- **Element Plus 2.6+**: 基于 Vue 3 的组件库
- **Tailwind CSS 3.4+**: 工具类优先的 CSS 框架
- 响应式设计，移动端友好

### 其他工具
- **markdown-it**: Markdown 解析器
- **highlight.js**: 代码高亮
- **PostCSS**: CSS 处理
- **Autoprefixer**: 自动添加浏览器前缀

## 项目结构详解

### src/components/
存放可复用的 Vue 组件

- **layout/**: 布局相关组件
  - `Header.vue`: 顶部导航栏
  - `Footer.vue`: 页脚
- **ArticleCard.vue**: 文章卡片组件

### src/views/
存放页面级组件

- `Home.vue`: 首页
- `ArticleList.vue`: 文章列表页
- `ArticleDetail.vue`: 文章详情页
- `About.vue`: 关于页面

### src/stores/
Pinia 状态管理

- `app.ts`: 应用全局状态（主题、用户信息）
- `article.ts`: 文章相关状态

### src/router/
路由配置

- `index.ts`: 路由定义和配置

### src/utils/
工具函数

- `markdown.ts`: Markdown 渲染相关
- `format.ts`: 格式化工具（日期、数字等）

### src/types/
TypeScript 类型定义

- `index.ts`: 全局类型定义

### src/mock/
模拟数据

- `articles.ts`: 文章数据

## 核心功能实现

### 1. Markdown 渲染

```typescript
// src/utils/markdown.ts
import MarkdownIt from 'markdown-it'
import hljs from 'highlight.js'

const md = new MarkdownIt({
  html: true,
  linkify: true,
  typographer: true,
  highlight: function (str, lang) {
    // 代码高亮逻辑
  }
})

export function renderMarkdown(content: string): string {
  return md.render(content)
}
```

### 2. 状态管理

```typescript
// src/stores/article.ts
export const useArticleStore = defineStore('article', () => {
  const articles = ref<Article[]>(mockArticles)
  
  const getArticlesByPage = (params: PaginationParams) => {
    // 分页逻辑
  }
  
  return { articles, getArticlesByPage }
})
```

### 3. 路由配置

```typescript
// src/router/index.ts
const routes: RouteRecordRaw[] = [
  {
    path: '/',
    component: Layout,
    children: [
      {
        path: '',
        name: 'Home',
        component: () => import('@/views/Home.vue')
      }
    ]
  }
]
```

## 开发规范

### 命名规范

- **组件文件**: PascalCase，如 `ArticleCard.vue`
- **工具文件**: camelCase，如 `markdown.ts`
- **组件名称**: PascalCase
- **变量/函数**: camelCase
- **常量**: UPPER_CASE
- **类型/接口**: PascalCase

### 目录规范

- 组件按功能分类放置
- 每个功能模块独立管理
- 避免深层嵌套（不超过 3 层）

### 代码规范

#### Vue 组件结构

```vue
<template>
  <!-- 模板 -->
</template>

<script setup lang="ts">
// 1. 导入
import { ref } from 'vue'

// 2. Props/Emits
interface Props {
  title: string
}
const props = defineProps<Props>()

// 3. 响应式数据
const count = ref(0)

// 4. 计算属性
const doubled = computed(() => count.value * 2)

// 5. 方法
function increment() {
  count.value++
}

// 6. 生命周期
onMounted(() => {
  // 初始化
})
</script>

<style scoped>
/* 样式 */
</style>
```

#### TypeScript 规范

```typescript
// 使用 interface 定义对象类型
interface User {
  id: number
  name: string
}

// 使用 type 定义联合类型、别名
type Status = 'pending' | 'success' | 'error'

// 函数参数和返回值都要有类型
function getUserName(user: User): string {
  return user.name
}

// 使用泛型
function getFirst<T>(arr: T[]): T | undefined {
  return arr[0]
}
```

### Tailwind CSS 使用规范

```vue
<!-- 推荐：使用工具类 -->
<div class="flex items-center justify-between p-4 bg-white rounded-lg shadow">
  <!-- 内容 -->
</div>

<!-- 响应式设计 -->
<div class="w-full md:w-1/2 lg:w-1/3">
  <!-- 内容 -->
</div>

<!-- 状态变体 -->
<button class="bg-blue-500 hover:bg-blue-700 active:bg-blue-800">
  按钮
</button>
```

## Git 提交规范

使用约定式提交（Conventional Commits）：

```
feat: 添加文章搜索功能
fix: 修复文章详情页加载问题
docs: 更新 README 文档
style: 优化文章卡片样式
refactor: 重构 Markdown 渲染逻辑
perf: 优化文章列表性能
test: 添加单元测试
chore: 更新依赖包
```

## 性能优化建议

### 1. 路由懒加载
```typescript
component: () => import('@/views/Home.vue')
```

### 2. 图片优化
- 使用 WebP 格式
- 添加 loading="lazy"
- 使用适当尺寸

### 3. 代码分割
```typescript
// 按需导入 Element Plus 组件
import { ElButton } from 'element-plus'
```

### 4. 缓存策略
```typescript
// 使用 computed 缓存计算结果
const filteredArticles = computed(() => {
  return articles.value.filter(/* ... */)
})
```

## 调试技巧

### Vue DevTools

安装 Vue DevTools 浏览器扩展，可以：
- 查看组件树
- 检查 Pinia 状态
- 追踪事件
- 性能分析

### Vite DevTools

开发时自动启用：
- 热模块替换（HMR）
- 错误提示
- 构建分析

### 控制台调试

```typescript
// 开发环境打印日志
if (import.meta.env.DEV) {
  console.log('Debug info:', data)
}
```

## 测试建议

### 单元测试
推荐使用 Vitest：

```bash
npm install -D vitest @vue/test-utils
```

```typescript
// article.spec.ts
import { describe, it, expect } from 'vitest'
import { useArticleStore } from '@/stores/article'

describe('ArticleStore', () => {
  it('should get articles by page', () => {
    const store = useArticleStore()
    const result = store.getArticlesByPage({ page: 1, pageSize: 10 })
    expect(result.data.length).toBeLessThanOrEqual(10)
  })
})
```

### E2E 测试
推荐使用 Playwright：

```bash
npm install -D @playwright/test
```

## 常用 npm 命令

```bash
# 开发
npm run dev              # 启动开发服务器
npm run build            # 构建生产版本
npm run preview          # 预览生产构建

# 代码检查（可选，需要配置）
npm run lint             # ESLint 检查
npm run format           # Prettier 格式化
npm run type-check       # TypeScript 类型检查
```

## 环境变量

创建 `.env` 文件：

```bash
# .env.development
VITE_API_URL=http://localhost:8080/api

# .env.production
VITE_API_URL=https://api.example.com
```

使用：

```typescript
const apiUrl = import.meta.env.VITE_API_URL
```

## 接入后端 API

### 1. 安装 axios

```bash
npm install axios
```

### 2. 创建 API 服务

```typescript
// src/api/article.ts
import axios from 'axios'
import type { Article } from '@/types'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL
})

export const articleApi = {
  getList: (page: number, pageSize: number) => {
    return api.get<Article[]>('/articles', {
      params: { page, pageSize }
    })
  },
  
  getById: (id: number) => {
    return api.get<Article>(`/articles/${id}`)
  }
}
```

### 3. 修改 Store

```typescript
// src/stores/article.ts
import { articleApi } from '@/api/article'

export const useArticleStore = defineStore('article', () => {
  const articles = ref<Article[]>([])
  const loading = ref(false)
  
  const fetchArticles = async () => {
    loading.value = true
    try {
      const { data } = await articleApi.getList(1, 10)
      articles.value = data
    } catch (error) {
      console.error('Failed to fetch articles:', error)
    } finally {
      loading.value = false
    }
  }
  
  return { articles, loading, fetchArticles }
})
```

## 部署配置

### Nginx 配置示例

```nginx
server {
  listen 80;
  server_name example.com;
  root /var/www/blog/dist;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
  }
}
```

## 扩展建议

### 添加 ESLint

```bash
npm install -D eslint @vue/eslint-config-typescript
npx eslint --init
```

### 添加 Prettier

```bash
npm install -D prettier eslint-config-prettier
```

### 添加 Husky (Git Hooks)

```bash
npm install -D husky lint-staged
npx husky init
```

## 学习资源

- [Vue 3 文档](https://cn.vuejs.org/)
- [TypeScript 文档](https://www.typescriptlang.org/zh/)
- [Pinia 文档](https://pinia.vuejs.org/zh/)
- [Tailwind CSS 文档](https://tailwindcss.com/)
- [Element Plus 文档](https://element-plus.org/zh-CN/)
- [Vite 文档](https://cn.vitejs.dev/)

## 问题排查

### 常见问题

1. **导入路径错误**: 确保使用 `@/` 别名
2. **类型错误**: 检查类型定义是否正确
3. **样式不生效**: 确保 Tailwind 配置正确
4. **组件未注册**: 检查是否正确导入

### 获取帮助

- 查看浏览器控制台错误
- 检查 Vue DevTools
- 查看 TypeScript 类型错误
- 阅读相关文档

---

祝开发顺利！🚀

